import{_ as Y}from"./auth-c67ad916.js";import{j as e,L as $}from"./index-a4776ee8.js";import{r as t}from"./vendor-e182443c.js";import{P as B}from"./index-03f6f705.js";import{u as je}from"./useRovingFocus-da6360a7.js";import{a5 as se,x as ce,R as Ne,a6 as Ce,w as Se,g as Ee,a7 as ze,G as ne,c as Me,t as Re,a8 as oe,Y as Ie,n as te,X as ke,u as Ue,a9 as Oe}from"./ui-9fedfdd7.js";import{p as H}from"./peopleService-db37a44e.js";import{H as Te}from"./HelpTooltip-4fed3476.js";const Q=typeof window<"u"?t.useLayoutEffect:t.useEffect;function ie(s){if(s!==void 0)switch(typeof s){case"number":return s;case"string":{if(s.endsWith("px"))return parseFloat(s);break}}}function Pe({box:s,defaultHeight:r,defaultWidth:n,disabled:i,element:d,mode:u,style:f}){const{styleHeight:g,styleWidth:x}=t.useMemo(()=>({styleHeight:ie(f?.height),styleWidth:ie(f?.width)}),[f?.height,f?.width]),[p,m]=t.useState({height:r,width:n}),N=i||u==="only-height"&&g!==void 0||u==="only-width"&&x!==void 0||g!==void 0&&x!==void 0;return Q(()=>{if(d===null||N)return;const a=new ResizeObserver(w=>{for(const y of w){const{contentRect:E,target:j}=y;d===j&&m(l=>l.height===E.height&&l.width===E.width?l:{height:E.height,width:E.width})}});return a.observe(d,{box:s}),()=>{a?.unobserve(d)}},[s,N,d,g,x]),t.useMemo(()=>({height:g??p.height,width:x??p.width}),[p,g,x])}function Ae(s){const r=t.useRef(()=>{throw new Error("Cannot call an event handler while rendering.")});return Q(()=>{r.current=s},[s]),t.useCallback(n=>r.current?.(n),[r])}let J=null;function Le(s=!1){if(J===null||s){const r=document.createElement("div"),n=r.style;n.width="50px",n.height="50px",n.overflow="scroll",n.direction="rtl";const i=document.createElement("div"),d=i.style;return d.width="100px",d.height="100px",r.appendChild(i),document.body.appendChild(r),r.scrollLeft>0?J="positive-descending":(r.scrollLeft=1,r.scrollLeft===0?J="negative":J="positive-ascending"),document.body.removeChild(r),J}return J}function re({containerElement:s,direction:r,isRtl:n,scrollOffset:i}){if(r==="horizontal"&&n)switch(Le()){case"negative":return-i;case"positive-descending":{if(s){const{clientWidth:d,scrollLeft:u,scrollWidth:f}=s;return f-d-u}break}}return i}function W(s,r="Assertion error"){if(!s)throw console.error(r),Error(r)}function Z(s,r){if(s===r)return!0;if(!!s!=!!r||(W(s!==void 0),W(r!==void 0),Object.keys(s).length!==Object.keys(r).length))return!1;for(const n in s)if(!Object.is(r[n],s[n]))return!1;return!0}function de({cachedBounds:s,itemCount:r,itemSize:n}){if(r===0)return 0;if(typeof n=="number")return r*n;{const i=s.get(s.size===0?0:s.size-1);W(i!==void 0,"Unexpected bounds cache miss");const d=(i.scrollOffset+i.size)/s.size;return r*d}}function _e({align:s,cachedBounds:r,index:n,itemCount:i,itemSize:d,containerScrollOffset:u,containerSize:f}){const g=de({cachedBounds:r,itemCount:i,itemSize:d}),x=r.get(n),p=Math.max(0,Math.min(g-f,x.scrollOffset)),m=Math.max(0,x.scrollOffset-f+x.size);switch(s==="smart"&&(u>=m&&u<=p?s="auto":s="center"),s){case"start":return p;case"end":return m;case"center":return x.scrollOffset<=f/2?0:x.scrollOffset+x.size/2>=g-f/2?g-f:x.scrollOffset+x.size/2-f/2;case"auto":default:return u>=m&&u<=p?u:u<m?m:p}}function le({cachedBounds:s,containerScrollOffset:r,containerSize:n,itemCount:i,overscanCount:d}){const u=i-1;let f=0,g=-1,x=0,p=-1,m=0;for(;m<u;){const N=s.get(m);if(N.scrollOffset+N.size>r)break;m++}for(f=m,x=Math.max(0,f-d);m<u;){const N=s.get(m);if(N.scrollOffset+N.size>=r+n)break;m++}return g=Math.min(u,m),p=Math.min(i-1,g+d),f<0&&(f=0,g=-1,x=0,p=-1),{startIndexVisible:f,stopIndexVisible:g,startIndexOverscan:x,stopIndexOverscan:p}}function De({itemCount:s,itemProps:r,itemSize:n}){const i=new Map;return{get(d){for(W(d<s,`Invalid index ${d}`);i.size-1<d;){const f=i.size;let g;switch(typeof n){case"function":{g=n(f,r);break}case"number":{g=n;break}}if(f===0)i.set(f,{size:g,scrollOffset:0});else{const x=i.get(f-1);W(x!==void 0,`Unexpected bounds cache miss for index ${d}`),i.set(f,{scrollOffset:x.scrollOffset+x.size,size:g})}}const u=i.get(d);return W(u!==void 0,`Unexpected bounds cache miss for index ${d}`),u},set(d,u){i.set(d,u)},get size(){return i.size}}}function Ve({itemCount:s,itemProps:r,itemSize:n}){return t.useMemo(()=>De({itemCount:s,itemProps:r,itemSize:n}),[s,r,n])}function $e({containerSize:s,itemSize:r}){let n;switch(typeof r){case"string":{W(r.endsWith("%"),`Invalid item size: "${r}"; string values must be percentages (e.g. "100%")`),W(s!==void 0,"Container size must be defined if a percentage item size is specified"),n=s*parseInt(r)/100;break}default:{n=r;break}}return n}function Be({containerElement:s,containerStyle:r,defaultContainerSize:n=0,direction:i,isRtl:d=!1,itemCount:u,itemProps:f,itemSize:g,onResize:x,overscanCount:p}){const[m,N]=t.useState({startIndexVisible:0,startIndexOverscan:0,stopIndexVisible:-1,stopIndexOverscan:-1}),{startIndexVisible:a,startIndexOverscan:w,stopIndexVisible:y,stopIndexOverscan:E}={startIndexVisible:Math.min(u-1,m.startIndexVisible),startIndexOverscan:Math.min(u-1,m.startIndexOverscan),stopIndexVisible:Math.min(u-1,m.stopIndexVisible),stopIndexOverscan:Math.min(u-1,m.stopIndexOverscan)},{height:j=n,width:l=n}=Pe({defaultHeight:i==="vertical"?n:void 0,defaultWidth:i==="horizontal"?n:void 0,element:s,mode:i==="vertical"?"only-height":"only-width",style:r}),b=t.useRef({height:0,width:0}),U=i==="vertical"?j:l,k=$e({containerSize:U,itemSize:g});t.useLayoutEffect(()=>{if(typeof x=="function"){const C=b.current;(C.height!==j||C.width!==l)&&(x({height:j,width:l},{...C}),C.height=j,C.width=l)}},[j,x,l]);const M=Ve({itemCount:u,itemProps:f,itemSize:k}),_=t.useCallback(C=>M.get(C),[M]),S=t.useCallback(()=>de({cachedBounds:M,itemCount:u,itemSize:k}),[M,u,k]),P=t.useCallback(C=>{const A=re({containerElement:s,direction:i,isRtl:d,scrollOffset:C});return le({cachedBounds:M,containerScrollOffset:A,containerSize:U,itemCount:u,overscanCount:p})},[M,s,U,i,d,u,p]);Q(()=>{const C=(i==="vertical"?s?.scrollTop:s?.scrollLeft)??0;N(P(C))},[s,i,P]),Q(()=>{if(!s)return;const C=()=>{N(A=>{const{scrollLeft:D,scrollTop:o}=s,c=re({containerElement:s,direction:i,isRtl:d,scrollOffset:i==="vertical"?o:D}),v=le({cachedBounds:M,containerScrollOffset:c,containerSize:U,itemCount:u,overscanCount:p});return Z(v,A)?A:v})};return s.addEventListener("scroll",C),()=>{s.removeEventListener("scroll",C)}},[M,s,U,i,u,p]);const R=Ae(({align:C="auto",containerScrollOffset:A,index:D})=>{let o=_e({align:C,cachedBounds:M,containerScrollOffset:A,containerSize:U,index:D,itemCount:u,itemSize:k});if(s){if(o=re({containerElement:s,direction:i,isRtl:d,scrollOffset:o}),typeof s.scrollTo!="function"){const c=P(o);Z(m,c)||N(c)}return o}});return{getCellBounds:_,getEstimatedSize:S,scrollToIndex:R,startIndexOverscan:w,startIndexVisible:a,stopIndexOverscan:E,stopIndexVisible:y}}function He(s){return t.useMemo(()=>s,Object.values(s))}function Fe(s,r){const{ariaAttributes:n,style:i,...d}=s,{ariaAttributes:u,style:f,...g}=r;return Z(n,u)&&Z(i,f)&&Z(d,g)}function We(s){return s!=null&&typeof s=="object"&&"getAverageRowHeight"in s&&typeof s.getAverageRowHeight=="function"}const Ke="data-react-window-index";function qe({children:s,className:r,defaultHeight:n=0,listRef:i,onResize:d,onRowsRendered:u,overscanCount:f=3,rowComponent:g,rowCount:x,rowHeight:p,rowProps:m,tagName:N="div",style:a,...w}){const y=He(m),E=t.useMemo(()=>t.memo(g,Fe),[g]),[j,l]=t.useState(null),b=We(p),U=t.useMemo(()=>b?o=>p.getRowHeight(o)??p.getAverageRowHeight():p,[b,p]),{getCellBounds:k,getEstimatedSize:M,scrollToIndex:_,startIndexOverscan:S,startIndexVisible:P,stopIndexOverscan:R,stopIndexVisible:C}=Be({containerElement:j,containerStyle:a,defaultContainerSize:n,direction:"vertical",itemCount:x,itemProps:y,itemSize:U,onResize:d,overscanCount:f});t.useImperativeHandle(i,()=>({get element(){return j},scrollToRow({align:o="auto",behavior:c="auto",index:v}){const I=_({align:o,containerScrollOffset:j?.scrollTop??0,index:v});typeof j?.scrollTo=="function"&&j.scrollTo({behavior:c,top:I})}}),[j,_]),Q(()=>{if(!j)return;const o=Array.from(j.children).filter((c,v)=>{if(c.hasAttribute("aria-hidden"))return!1;const I=`${S+v}`;return c.setAttribute(Ke,I),!0});if(b)return p.observeRowElements(o)},[j,b,p,S,R]),t.useEffect(()=>{S>=0&&R>=0&&u&&u({startIndex:P,stopIndex:C},{startIndex:S,stopIndex:R})},[u,S,P,R,C]);const A=t.useMemo(()=>{const o=[];if(x>0)for(let c=S;c<=R;c++){const v=k(c);o.push(t.createElement(E,{...y,ariaAttributes:{"aria-posinset":c+1,"aria-setsize":x,role:"listitem"},key:c,index:c,style:{position:"absolute",left:0,transform:`translateY(${v.scrollOffset}px)`,height:b?void 0:v.size,width:"100%"}}))}return o},[E,k,b,x,y,S,R]),D=e.jsx("div",{"aria-hidden":!0,style:{height:M(),width:"100%",zIndex:-1}});return t.createElement(N,{role:"list",...w,className:r,ref:l,style:{position:"relative",maxHeight:"100%",flexGrow:1,overflowY:"auto",...a}},A,s,D)}const Ye=qe,ae=t.forwardRef(({items:s,renderItem:r,itemHeight:n=80,height:i=600,className:d="",ariaLabel:u="Virtual list",testId:f="virtual-list"},g)=>{const x=t.useRef(null);if(!s||s.length===0)return e.jsx("div",{className:`text-center py-8 ${d}`,role:"status","data-testid":`${f}-empty`,children:e.jsx("p",{className:"text-professional-gray-500",children:"No items to display"})});const p=({index:m,style:N})=>{const a=s[m];return e.jsx("div",{style:N,role:"listitem","aria-setsize":s.length,"aria-posinset":m+1,tabIndex:0,onKeyDown:w=>{if(w.key==="ArrowDown"&&m<s.length-1){w.preventDefault();const y=w.currentTarget.nextElementSibling;y&&y.focus()}else if(w.key==="ArrowUp"&&m>0){w.preventDefault();const y=w.currentTarget.previousElementSibling;y&&y.focus()}},children:r(a,m,N)})};return p.propTypes={index:B.number.isRequired,style:B.object.isRequired},e.jsx("div",{className:d,"data-testid":f,children:e.jsx(Ye,{ref:x,height:i,itemCount:s.length,itemSize:n,width:"100%",role:"list","aria-label":u,className:"focus:outline-none",children:p})})});ae.displayName="VirtualList";ae.propTypes={items:B.array.isRequired,renderItem:B.func.isRequired,itemHeight:B.number,height:B.number,className:B.string,ariaLabel:B.string,testId:B.string};const Ge=ae;function Je({coaches:s,onSelect:r,onUnassignUser:n,onReplaceCoach:i}){const[d,u]=t.useState({}),{getItemProps:f,onKeyDown:g}=je(s?.length||0,{loop:!0,direction:"vertical"}),x=a=>{u(w=>({...w,[a]:!w[a]}))},p=(a,w,y)=>{g(a),(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),w())};if(!s||s.length===0)return e.jsx("div",{className:"text-center py-12 text-professional-gray-500",children:e.jsx("p",{children:"No coaches found."})});const m=s.length>100,N=(a,w,y={})=>{const E=d[a.id],j=f(w);return e.jsx("div",{style:m?{...y,padding:"4px 0"}:{},className:m?"":"mb-2",children:e.jsxs("div",{className:"bg-white border border-professional-gray-200 rounded-lg hover:shadow-md transition-all duration-200",children:[e.jsx("div",{...j,className:"p-3 cursor-pointer hover:bg-professional-gray-50 focus:outline-none focus:ring-2 focus:ring-netsurit-red focus:ring-offset-2 rounded-lg",onClick:()=>r(a),onKeyDown:l=>p(l,()=>r(a)),role:"button","aria-label":`View ${a.name}'s team details`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[e.jsx("img",{src:a.avatar,alt:`${a.name}'s profile`,className:"w-9 h-9 rounded-full object-cover flex-shrink-0",onError:l=>{l.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(a.name)}&background=6366f1&color=fff&size=36`}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(se,{className:"w-3.5 h-3.5 text-netsurit-red flex-shrink-0","aria-label":"Coach"}),e.jsx("h3",{className:"text-sm font-semibold text-professional-gray-900 truncate",children:a.name})]}),e.jsx("p",{className:"text-xs text-professional-gray-600 truncate",children:a.teamName}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsxs("span",{className:"text-xs text-professional-gray-500 flex items-center",children:[e.jsx(ce,{className:"w-3 h-3 mr-1","aria-hidden":"true"}),a.office]})})]})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3 text-xs",role:"group","aria-label":"Team statistics",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-professional-gray-900",children:a.teamMetrics?.teamSize||0}),e.jsx("div",{className:"text-professional-gray-500",children:"team"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-professional-gray-900",children:a.performanceScore||0}),e.jsx("div",{className:"text-professional-gray-500",children:"score"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"font-semibold text-professional-gray-900",children:[a.teamMetrics?.engagementRate||0,"%"]}),e.jsx("div",{className:"text-professional-gray-500",children:"engaged"})]})]}),e.jsxs("div",{className:"flex items-center gap-1",role:"group","aria-label":"Coach actions",children:[e.jsx("button",{onClick:l=>{l.stopPropagation(),i(a)},onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),l.stopPropagation(),i(a))},className:"p-1.5 text-netsurit-orange hover:text-netsurit-warm-orange hover:bg-netsurit-orange/10 rounded transition-colors border border-netsurit-orange/20",title:"Replace Coach","aria-label":`Replace ${a.name} as coach`,children:e.jsx(Ne,{className:"w-4 h-4","aria-hidden":"true"})}),e.jsx("button",{onClick:l=>{l.stopPropagation(),x(a.id)},onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),l.stopPropagation(),x(a.id))},className:"p-1.5 text-professional-gray-400 hover:text-professional-gray-600 hover:bg-professional-gray-100 rounded transition-colors",title:E?"Collapse Team":"Expand Team","aria-label":E?"Collapse team members":"Expand team members","aria-expanded":E,children:E?e.jsx(Ce,{className:"w-4 h-4","aria-hidden":"true"}):e.jsx(Se,{className:"w-4 h-4","aria-hidden":"true"})}),e.jsx(Ee,{className:"w-4 h-4 text-netsurit-red","aria-hidden":"true"})]})]})]})}),E&&a.teamMetrics?.teamMembers&&e.jsx("div",{className:"border-t border-professional-gray-100 bg-professional-gray-50",role:"region","aria-label":`${a.name}'s team members`,children:e.jsx("div",{className:"p-3 space-y-2",children:a.teamMetrics.teamMembers.map(l=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-white rounded border border-professional-gray-100",role:"listitem",tabIndex:0,onKeyDown:b=>{(b.key==="Enter"||b.key===" ")&&!l.isCoach&&(b.preventDefault(),n(l,a.id))},children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("img",{src:l.avatar,alt:`${l.name}'s profile`,className:"w-6 h-6 rounded-full object-cover",onError:b=>{b.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(l.name)}&background=6366f1&color=fff&size=24`}}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("p",{className:"text-xs font-medium text-professional-gray-900",children:l.name}),l.isCoach&&e.jsx(se,{className:"w-3 h-3 text-netsurit-red",title:"Team Coach","aria-label":"Coach badge"})]}),e.jsx("p",{className:"text-xs text-professional-gray-500",children:l.office})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-xs font-semibold text-professional-gray-900","aria-label":`Score: ${l.score||0} points`,children:[l.score||0,"pt"]}),!l.isCoach&&e.jsx("button",{onClick:b=>{b.stopPropagation(),n(l,a.id)},onKeyDown:b=>{(b.key==="Enter"||b.key===" ")&&(b.preventDefault(),b.stopPropagation(),n(l,a.id))},className:"p-1 text-professional-gray-400 hover:text-netsurit-red hover:bg-netsurit-red/10 rounded transition-colors",title:"Unassign from team","aria-label":`Unassign ${l.name} from team`,children:e.jsx(ze,{className:"w-3.5 h-3.5","aria-hidden":"true"})})]})]},l.id))})})]})},a.id)};return m?e.jsx(Ge,{items:s,renderItem:N,itemHeight:120,height:600,ariaLabel:"Virtual coach teams list",testId:"coach-list-virtual",className:"rounded-lg"}):e.jsx("div",{className:"space-y-2",role:"list","aria-label":"Coach teams list","data-testid":"coach-list-regular",children:s.map((a,w)=>N(a,w))})}function Xe(){const[s,r]=t.useState([]),[n,i]=t.useState([]),[d,u]=t.useState({}),[f,g]=t.useState({}),[x,p]=t.useState(!0),[m,N]=t.useState(null),[a,w]=t.useState("all"),[y,E]=t.useState(""),[j,l]=t.useState("performance"),[b,U]=t.useState(!1),[k,M]=t.useState("");t.useEffect(()=>{_()},[]);const _=t.useCallback(async()=>{try{p(!0),N(null),await H.initializeLocalStorage();const[o,c]=await Promise.all([H.getAllUsers(),H.getTeamRelationships()]),v=o.success?o.data:[],I=c.success?c.data:[];r(v),i(I);const K=I.map(F=>H.getTeamMetrics(F.managerId).then(V=>V.success?V.data:null).catch(()=>null)),q=I.map(F=>H.getCoachingAlerts(F.managerId).then(V=>V.success?V.data:[]).catch(()=>[])),[X,O]=await Promise.all([Promise.all(K),Promise.all(q)]),L={},T={};I.forEach((F,V)=>{L[F.managerId]=X[V],T[F.managerId]=O[V]}),u(L),g(T),console.log("✅ People dashboard data loaded successfully")}catch(o){console.error("❌ Error loading people dashboard data:",o),N(o.message)}finally{p(!1)}},[]),S=t.useMemo(()=>n.map(o=>{const c=s.find(K=>K.id===o.managerId),v=d[o.managerId],I=f[o.managerId]||[];return{...c,teamName:o.teamName,teamMetrics:v,alerts:I,performanceScore:v?v.averageScore:0,teamData:o}}).filter(o=>o.id),[n,s,d,f]),P=t.useMemo(()=>S.filter(c=>{const v=a==="all"||c.office===a,I=c.name?.toLowerCase().includes(y.toLowerCase())||c.teamName?.toLowerCase().includes(y.toLowerCase());return v&&I}).sort((c,v)=>{switch(j){case"name":return(c.name||"").localeCompare(v.name||"");case"team-size":return(v.teamMetrics?.teamSize||0)-(c.teamMetrics?.teamSize||0);case"alerts":return(v.alerts?.length||0)-(c.alerts?.length||0);default:return(v.performanceScore||0)-(c.performanceScore||0)}}),[S,a,y,j]),R=t.useMemo(()=>{const o=new Set(n.map(v=>v.managerId)),c=new Set(n.flatMap(v=>v.teamMembers||[]));return s.filter(v=>!o.has(v.id)&&!c.has(v.id))},[s,n]),C=t.useMemo(()=>{let o=b?s:R;return k.trim()&&(o=o.filter(c=>c.name?.toLowerCase().includes(k.toLowerCase())||c.email?.toLowerCase().includes(k.toLowerCase())||c.office?.toLowerCase().includes(k.toLowerCase()))),o},[b,s,R,k]),A=t.useMemo(()=>{const o=s.length,c=S.length,v=S.reduce((O,L)=>O+(L.teamMetrics?.teamSize||0),0),I=R.length,K=S.length>0?S.reduce((O,L)=>O+(L.teamMetrics?.engagementRate||0),0)/S.length:0,q=S.reduce((O,L)=>O+(L.alerts?.length||0),0),X=S.length>0?S.reduce((O,L)=>O+(L.performanceScore||0),0)/S.length:0;return{totalEmployees:o,totalCoaches:c,totalTeamMembers:v,totalUnassigned:I,avgEngagement:Math.round(K||0),totalAlerts:q,avgTeamScore:Math.round(X||0),programAdoption:o>0?Math.round((v+c)/o*100):0}},[S,s.length,R.length]),D=t.useMemo(()=>[...new Set(s.map(o=>o.office).filter(Boolean))],[s]);return{allUsers:s,coaches:P,unassignedUsers:R,displayedUsers:C,overallMetrics:A,offices:D,teamRelationships:n,loading:x,error:m,filterOffice:a,setFilterOffice:w,searchTerm:y,setSearchTerm:E,sortBy:j,setSortBy:l,showAllUsers:b,setShowAllUsers:U,userSearchTerm:k,setUserSearchTerm:M,refreshData:_}}const Ze=t.lazy(()=>Y(()=>import("./CoachDetailModal-828daf26.js"),["assets/CoachDetailModal-828daf26.js","assets/index-a4776ee8.js","assets/vendor-e182443c.js","assets/auth-c67ad916.js","assets/ui-9fedfdd7.js","assets/index-33578cc9.css","assets/index-03f6f705.js"])),Qe=t.lazy(()=>Y(()=>import("./ReportBuilderModal-c39f0c42.js"),["assets/ReportBuilderModal-c39f0c42.js","assets/index-a4776ee8.js","assets/vendor-e182443c.js","assets/auth-c67ad916.js","assets/ui-9fedfdd7.js","assets/index-33578cc9.css"])),es=t.lazy(()=>Y(()=>import("./UnassignUserModal-a46cc7cd.js"),["assets/UnassignUserModal-a46cc7cd.js","assets/index-a4776ee8.js","assets/vendor-e182443c.js","assets/auth-c67ad916.js","assets/ui-9fedfdd7.js","assets/index-33578cc9.css"])),ss=t.lazy(()=>Y(()=>import("./ReplaceCoachModal-dd8d2f30.js"),["assets/ReplaceCoachModal-dd8d2f30.js","assets/index-a4776ee8.js","assets/vendor-e182443c.js","assets/auth-c67ad916.js","assets/ui-9fedfdd7.js","assets/index-33578cc9.css"])),ts=t.lazy(()=>Y(()=>import("./EditUserModal-844f9e52.js"),["assets/EditUserModal-844f9e52.js","assets/index-a4776ee8.js","assets/vendor-e182443c.js","assets/auth-c67ad916.js","assets/ui-9fedfdd7.js","assets/index-33578cc9.css","assets/index-03f6f705.js"])),rs=t.lazy(()=>Y(()=>import("./PromoteUserModal-00600725.js"),["assets/PromoteUserModal-00600725.js","assets/index-a4776ee8.js","assets/vendor-e182443c.js","assets/auth-c67ad916.js","assets/ui-9fedfdd7.js","assets/index-33578cc9.css","assets/index-03f6f705.js"])),as=t.lazy(()=>Y(()=>import("./AssignUserModal-e3bfaf0c.js"),["assets/AssignUserModal-e3bfaf0c.js","assets/index-a4776ee8.js","assets/vendor-e182443c.js","assets/auth-c67ad916.js","assets/ui-9fedfdd7.js","assets/index-33578cc9.css","assets/index-03f6f705.js"]));function hs(){const{allUsers:s,coaches:r,unassignedUsers:n,displayedUsers:i,overallMetrics:d,teamRelationships:u,loading:f,error:g,searchTerm:x,setSearchTerm:p,showAllUsers:m,setShowAllUsers:N,userSearchTerm:a,setUserSearchTerm:w,refreshData:y}=Xe(),[E,j]=t.useState(null),[l,b]=t.useState(!1),[U,k]=t.useState(!1),[M,_]=t.useState(null),[S,P]=t.useState(!1),[R,C]=t.useState(null),[A,D]=t.useState(!1),[o,c]=t.useState(null),[v,I]=t.useState(!1),[K,q]=t.useState(!1),[X,O]=t.useState(!1),[L,T]=t.useState(!1),F=h=>{console.log("🔍 Viewing coach:",h.name),j(h),b(!0)},V=(h,z)=>{_({user:h,coachId:z}),P(!0)},ue=h=>{C(h),D(!0)},me=h=>{c(h),I(!0)},he=h=>{c(h),q(!0)},fe=h=>{c(h),O(!0)},xe=async h=>{try{T(!0),(await fetch(`/api/updateUserProfile/${o.id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...h,region:h.office})})).ok?(console.log("✅ User profile updated successfully"),await y(),I(!1),c(null)):(console.error("❌ Failed to update user profile"),alert("Failed to update profile. Please try again."))}catch(z){console.error("❌ Error updating user profile:",z),alert("Error updating profile. Please try again.")}finally{T(!1)}},pe=async h=>{try{T(!0);const z=await H.promoteUserToCoach(o.id,h);z.success?(console.log(`✅ Successfully promoted ${o.name} to coach`),await y(),q(!1),c(null)):(console.error("❌ Failed to promote user:",z.error),alert("Failed to promote user. Please try again."))}catch(z){console.error("❌ Error promoting user:",z),alert("Error promoting user. Please try again.")}finally{T(!1)}},ge=async h=>{try{T(!0);const z=await H.assignUserToCoach(o.id,h);z.success?(console.log(`✅ Successfully assigned ${o.name} to coach`),await y(),O(!1),c(null)):(console.error("❌ Failed to assign user:",z.error),alert("Failed to assign user. Please try again."))}catch(z){console.error("❌ Error assigning user:",z),alert("Error assigning user. Please try again.")}finally{T(!1)}},ve=async(h,z)=>{try{T(!0);const G=await H.unassignUserFromTeam(h.id,z);G.success?(console.log(`✅ Successfully unassigned ${h.name}`),await y(),P(!1),_(null)):console.error("❌ Failed to unassign user:",G.error)}catch(G){console.error("❌ Error unassigning user:",G)}finally{T(!1)}},ye=async(h,z,G,be,we)=>{try{T(!0);const ee=await H.replaceTeamCoach(h,z,G,be,we);ee.success?(console.log("✅ Successfully replaced coach"),await y(),D(!1),C(null)):console.error("❌ Failed to replace coach:",ee.error)}catch(ee){console.error("❌ Error replacing coach:",ee)}finally{T(!1)}};return f?e.jsx($,{}):g?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx(ne,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-professional-gray-900 mb-2",children:"Error Loading Data"}),e.jsx("p",{className:"text-professional-gray-600 mb-4",children:g}),e.jsx("button",{onClick:y,className:"bg-gradient-to-r from-netsurit-red to-netsurit-coral text-white px-6 py-2 rounded-lg hover:from-netsurit-coral hover:to-netsurit-orange transition-all duration-200",children:"Try Again"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"px-4 sm:px-6 pt-4 sm:pt-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(Me,{className:"h-8 w-8 text-netsurit-red"}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-professional-gray-900",children:"People Dashboard"}),e.jsx(Te,{title:"People Dashboard Guide",content:"HR oversight dashboard to manage coaches and teams. View all coaches and their teams, monitor program engagement metrics, promote users to coaches, assign/unassign team members, and generate reports."})]}),e.jsx("p",{className:"text-professional-gray-600",children:"HR oversight of coaches, teams, and program engagement"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border border-professional-gray-200 hover:shadow-md transition-shadow text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx(Re,{className:"h-6 w-6 text-netsurit-red"})}),e.jsx("p",{className:"text-xs font-medium text-professional-gray-500 uppercase tracking-wide",children:"Adoption"}),e.jsxs("p",{className:"text-xl font-bold text-professional-gray-900",children:[d.programAdoption,"%"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border border-professional-gray-200 hover:shadow-md transition-shadow text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx(se,{className:"h-6 w-6 text-netsurit-coral"})}),e.jsx("p",{className:"text-xs font-medium text-professional-gray-500 uppercase tracking-wide",children:"Coaches"}),e.jsx("p",{className:"text-xl font-bold text-professional-gray-900",children:d.totalCoaches})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border border-professional-gray-200 hover:shadow-md transition-shadow text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx(oe,{className:"h-6 w-6 text-netsurit-orange"})}),e.jsx("p",{className:"text-xs font-medium text-professional-gray-500 uppercase tracking-wide",children:"Unassigned"}),e.jsx("p",{className:"text-xl font-bold text-professional-gray-900",children:d.totalUnassigned})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border border-professional-gray-200 hover:shadow-md transition-shadow text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx(ne,{className:"h-6 w-6 text-netsurit-warm-orange"})}),e.jsx("p",{className:"text-xs font-medium text-professional-gray-500 uppercase tracking-wide",children:"Alerts"}),e.jsx("p",{className:"text-xl font-bold text-professional-gray-900",children:d.totalAlerts})]})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("button",{onClick:()=>k(!0),className:"bg-gradient-to-r from-netsurit-red to-netsurit-coral text-white px-4 py-2 rounded-xl hover:from-netsurit-coral hover:to-netsurit-orange focus:outline-none focus:ring-2 focus:ring-netsurit-red focus:ring-offset-2 transition-all duration-200 shadow-md hover:shadow-lg flex items-center","aria-label":"Open report builder",children:[e.jsx(Ie,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),e.jsx("span",{children:"Report Builder"})]})})]})}),e.jsx("div",{className:"px-4 sm:px-6 pb-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-lg border border-professional-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-bold text-professional-gray-900",children:"Coaches & Teams"}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(te,{className:"w-4 h-4 text-professional-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2","aria-hidden":"true"}),e.jsx("input",{type:"text",placeholder:"Search coaches or teams...",value:x,onChange:h=>p(h.target.value),className:"w-full pl-9 pr-3 py-2 border border-professional-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-netsurit-red focus:border-netsurit-red transition-all duration-200 text-sm","aria-label":"Search coaches or teams"})]})})]})}),e.jsx(Je,{coaches:r,onSelect:F,onUnassignUser:V,onReplaceCoach:ue})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-lg border border-professional-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("h2",{className:"text-xl font-bold text-professional-gray-900 flex-shrink-0",children:m?"All Users":"Unassigned Users"}),e.jsx("div",{className:"flex-1 max-w-xs",children:e.jsxs("div",{className:"relative",children:[e.jsx(te,{className:"w-4 h-4 text-professional-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2","aria-hidden":"true"}),e.jsx("input",{type:"text",placeholder:`Search ${m?"all users":"unassigned users"}...`,value:a,onChange:h=>w(h.target.value),className:"w-full pl-9 pr-3 py-2 border border-professional-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-netsurit-red focus:border-netsurit-red transition-all duration-200 text-sm","aria-label":`Search ${m?"all users":"unassigned users"}`}),a&&e.jsx("button",{onClick:()=>w(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 p-1 text-professional-gray-400 hover:text-netsurit-red transition-colors duration-200",title:"Clear search","aria-label":"Clear search",children:e.jsx(ke,{className:"w-3.5 h-3.5","aria-hidden":"true"})})]})}),e.jsx("button",{onClick:()=>N(!m),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-all duration-200 flex-shrink-0 ${m?"bg-gradient-to-r from-netsurit-red to-netsurit-coral text-white hover:from-netsurit-coral hover:to-netsurit-orange":"bg-professional-gray-100 text-professional-gray-700 hover:bg-professional-gray-200"}`,"aria-label":m?"Show only unassigned users":"Show all users",children:m?"Show Unassigned":"Show All Users"})]})}),e.jsxs("div",{className:"space-y-3",role:"list","aria-label":"User list",children:[i.map(h=>e.jsx("div",{className:"bg-white border border-professional-gray-200 rounded-lg p-4 hover:shadow-md transition-all duration-200",role:"listitem",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[e.jsx("img",{src:h.avatar,alt:h.name,className:"w-12 h-12 rounded-full object-cover flex-shrink-0 ring-2 ring-professional-gray-100",onError:z=>{z.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(h.name)}&background=EC4B5C&color=fff&size=100`}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-professional-gray-900 truncate",children:h.name}),e.jsx("button",{onClick:()=>me(h),className:"p-1 text-professional-gray-400 hover:text-netsurit-red transition-colors duration-200",title:"Edit user","aria-label":`Edit ${h.name}`,children:e.jsx(Ue,{className:"w-3.5 h-3.5"})})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap text-xs text-professional-gray-500 mt-0.5",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(ce,{className:"w-3 h-3 mr-1"}),h.office]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[h.score||0,"pts"]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[h.dreamsCount||0," dreams"]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[h.connectsCount||0," connects"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsxs("button",{onClick:()=>he(h),className:"flex items-center gap-1.5 px-3 py-1.5 bg-gradient-to-r from-netsurit-red to-netsurit-coral text-white text-xs font-medium rounded-md hover:from-netsurit-coral hover:to-netsurit-orange transition-all duration-200 shadow-sm hover:shadow-md",title:"Promote to coach",children:[e.jsx(se,{className:"w-3.5 h-3.5"}),"Promote"]}),e.jsxs("button",{onClick:()=>fe(h),className:"flex items-center gap-1.5 px-3 py-1.5 bg-professional-gray-700 text-white text-xs font-medium rounded-md hover:bg-professional-gray-800 transition-all duration-200",title:"Assign to coach",children:["Assign to Coach",e.jsx(Oe,{className:"w-3.5 h-3.5"})]})]})]})},h.id)),i.length===0&&e.jsx("div",{className:"text-center py-12",children:a?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"w-16 h-16 text-professional-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-bold text-professional-gray-900 mb-2",children:"No users found"}),e.jsxs("p",{className:"text-professional-gray-500",children:["No ",m?"users":"unassigned users",' match "',a,'"']}),e.jsx("button",{onClick:()=>w(""),className:"mt-3 text-sm text-netsurit-red hover:text-netsurit-coral transition-colors duration-200",children:"Clear search"})]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"w-16 h-16 text-professional-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-bold text-professional-gray-900 mb-2",children:m?"No users found":"All users assigned"}),e.jsx("p",{className:"text-professional-gray-500",children:m?"There are no users in the system":"Every user is either a coach or assigned to a team"})]})})]})]})]})}),l&&E&&e.jsx(t.Suspense,{fallback:e.jsx($,{}),children:e.jsx(Ze,{coach:E,onClose:()=>{b(!1),j(null)}})}),U&&e.jsx(t.Suspense,{fallback:e.jsx($,{}),children:e.jsx(Qe,{isOpen:U,onClose:()=>k(!1),allUsers:s,teamRelationships:u})}),S&&M&&e.jsx(t.Suspense,{fallback:e.jsx($,{}),children:e.jsx(es,{user:M.user,coachId:M.coachId,coaches:r,onClose:()=>{P(!1),_(null)},onConfirm:()=>ve(M.user,M.coachId)})}),A&&R&&e.jsx(t.Suspense,{fallback:e.jsx($,{}),children:e.jsx(ss,{coach:R,availableReplacements:s.filter(h=>h.id!==R.id),coaches:r,onClose:()=>{D(!1),C(null)},onConfirm:ye})}),v&&o&&e.jsx(t.Suspense,{fallback:e.jsx($,{}),children:e.jsx(ts,{user:o,coaches:r,onClose:()=>{I(!1),c(null)},onSave:xe})}),K&&o&&e.jsx(t.Suspense,{fallback:e.jsx($,{}),children:e.jsx(rs,{user:o,onClose:()=>{q(!1),c(null)},onConfirm:pe})}),X&&o&&e.jsx(t.Suspense,{fallback:e.jsx($,{}),children:e.jsx(as,{user:o,coaches:r,onClose:()=>{O(!1),c(null)},onConfirm:ge})}),L&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx($,{})})]})}export{hs as default};
